#!/usr/bin/env python
# -*- coding: utf-8 -*-
import my_tasks
from task.models import Task

"""
вставать из-за компа каждые 20 минут
"""


class Stand_up(my_tasks.Now):
    name = "Разминка для позвоночника"

    def todo(self):
        if self.elapsed and self.elapsed < 20*60:
            return False
        if self.shell("afk")>60:
            return False
        if self.psql('SELECT COUNT(*) FROM last_30minutes WHERE available=true',"afk")<20:
            return
        if self.psql('SELECT COUNT(*) FROM last_20minutes WHERE min_afk>60',"afk")>5:
            return
        if self.psql('SELECT COUNT(*) FROM last_20minutes WHERE max_afk<60',"afk") > 10:
            return
        return True

if __name__ == "__main__":
    print(Task.objects.get(class_name=Stand_up.__name__))
