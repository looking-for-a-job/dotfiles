#!/usr/bin/env python
from task.models import Category
import os

XDG_DATA_HOME = os.getenv("XDG_DATA_HOME", os.path.expanduser("~/.local/share"))
TODO = os.path.join(XDG_DATA_HOME, "TODO")

"""
displayas:  1 - folder, 2 - stack (default)
showas:     1 - beep, 2 - grid, 3 - list, 4 - auto (default)
"""


class Today:
    @property
    def path(self):
        return os.path.join(TODO, "Today")

    def files(self):
        result = []
        for f in os.listdir(self.path):
            if os.path.splitext(f)[1] == ".txt":
                result.append(os.path.join(self.path, f))
        return result


def get_or_create(name, **kwargs):
    if __name__ == "__main__":
        raise ImportError("direct run now allowed")
    kwargs.update(name=name, module_name=__name__)
    category, created = Category.objects.get_or_create(**kwargs)
    return category


DOCS = get_or_create("docs")
TODAY = get_or_create("today", parent=DOCS, class_name=Today.__name__)

DOCS.TODAY = TODAY
